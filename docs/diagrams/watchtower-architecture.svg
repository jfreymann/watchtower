<svg width="900" height="420" viewBox="0 0 900 420" xmlns="http://www.w3.org/2000/svg">
  <style>
    .box { fill:#111827; stroke:#4B5563; stroke-width:1.2; rx:8; ry:8; }
    .label { fill:#E5E7EB; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size:13px; }
    .title { fill:#FBBF24; font-weight:600; font-size:15px; }
    .caption { fill:#9CA3AF; font-size:11px; }
    .arrow { stroke:#9CA3AF; stroke-width:1.4; marker-end:url(#arrowhead); }
    .bg { fill:#020617; }
  </style>

  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#9CA3AF"></polygon>
    </marker>
  </defs>

  <rect class="bg" x="0" y="0" width="900" height="420"></rect>

  <!-- Title -->
  <text x="450" y="36" text-anchor="middle" class="title">Watchtower â€“ High-Level Architecture</text>
  <text x="450" y="54" text-anchor="middle" class="caption">Distributed login telemetry from Linux hosts to a central collector</text>

  <!-- Agents group -->
  <rect class="box" x="40" y="90" width="260" height="260"></rect>
  <text x="170" y="112" text-anchor="middle" class="label">Watchtower Agents</text>
  <text x="170" y="130" text-anchor="middle" class="caption">(per Linux host)</text>

  <!-- Agent 1 -->
  <rect class="box" x="60" y="150" width="220" height="70"></rect>
  <text x="90" y="172" class="label">Linux Host</text>
  <text x="90" y="190" class="caption">journald: ssh.service</text>
  <text x="250" y="172" text-anchor="end" class="label">Watchtower Agent</text>
  <text x="250" y="190" text-anchor="end" class="caption">Parses SSH logins</text>

  <!-- Agent 2 -->
  <rect class="box" x="60" y="235" width="220" height="70"></rect>
  <text x="90" y="257" class="label">Linux Host</text>
  <text x="90" y="275" class="caption">journald: ssh.service</text>
  <text x="250" y="257" text-anchor="end" class="label">Watchtower Agent</text>
  <text x="250" y="275" text-anchor="end" class="caption">Adds metadata</text>

  <!-- Arrow from agents to collector -->
  <line class="arrow" x1="300" y1="210" x2="600" y2="210"></line>
  <text x="450" y="196" text-anchor="middle" class="caption">HTTPS (TLS) + Token Auth</text>

  <!-- Collector box -->
  <rect class="box" x="600" y="90" width="260" height="260"></rect>
  <text x="730" y="112" text-anchor="middle" class="label">Watchtower Collector</text>
  <text x="730" y="130" text-anchor="middle" class="caption">(FastAPI + SQLite)</text>

  <!-- Caddy -->
  <rect class="box" x="620" y="150" width="220" height="60"></rect>
  <text x="730" y="172" text-anchor="middle" class="label">Caddy Reverse Proxy</text>
  <text x="730" y="190" text-anchor="middle" class="caption">TLS, IP fencing, reverse proxy</text>

  <!-- FastAPI -->
  <rect class="box" x="620" y="225" width="220" height="60"></rect>
  <text x="730" y="247" text-anchor="middle" class="label">FastAPI Application</text>
  <text x="730" y="265" text-anchor="middle" class="caption">/login, /events, /healthz</text>

  <!-- DB -->
  <ellipse cx="730" cy="315" rx="80" ry="26" fill="#020617" stroke="#4B5563" stroke-width="1.2"></ellipse>
  <text x="730" y="317" text-anchor="middle" class="label">SQLite: login_events</text>
</svg>
